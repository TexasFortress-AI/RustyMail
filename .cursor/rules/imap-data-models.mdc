# imap-data-models

### Email Model Structure
- MUST: Define Email struct with fields:
  ```rust
  struct Email {
    uid: u32,
    flags: Vec<String>,
    envelope: ImapEnvelope,
    body: Option<String>, 
    size: u32
  }
  ```
- AVOID: Storing raw IMAP message data directly
- WHY: Provides clean domain model for email manipulation
- EXAMPLE: `src/imap/types.rs`

### Envelope Data Model 
- MUST: Implement ImapEnvelope with:
  - From/To/CC addresses as ImapAddress vectors
  - Subject and date as Strings
  - Message-ID and In-Reply-To for threading
- AVOID: Custom string parsing of envelope data
- WHY: Standardizes email metadata handling
- EXAMPLE: `src/imap/types.rs`

### Address Structure
- MUST: Model ImapAddress with:
  ```rust
  struct ImapAddress {
    name: Option<String>,
    mailbox: String,
    host: String
  }
  ```
- AVOID: Free-form address strings
- WHY: Enables proper email address validation and formatting
- EXAMPLE: `src/imap/types.rs`

### Folder Model
- MUST: Implement Folder with:
  - Name as String
  - Delimiter as char
  - Metadata via MailboxInfo struct
- AVOID: Nested folder hierarchies in memory
- WHY: Maps to IMAP folder structure
- EXAMPLE: `src/imap/types.rs`

### Search Criteria Model
- MUST: Define SearchCriteria enum with:
  - Basic criteria (Subject, From, Body etc)
  - Compound criteria (And, Or, Not)
  - Date-based criteria
- AVOID: Raw IMAP search strings
- WHY: Type-safe search query construction
- EXAMPLE: `src/imap/types.rs`

### Flag Operations
- MUST: Model flag changes via:
  ```rust
  enum FlagOperation {
    Add(Vec<String>),
    Remove(Vec<String>),
    Set(Vec<String>)
  }
  ```
- AVOID: Direct flag string manipulation
- WHY: Safe flag state transitions
- EXAMPLE: `src/imap/types.rs`

### Testing Requirements
- MUST: Test all model serialization/deserialization
- MUST: Validate all field constraints
- MUST: Test flag operation combinations
- MUST: Verify search criteria composition
- AVOID: Testing raw IMAP protocol details
- EXAMPLE: `src/imap/types_test.rs`

$END$